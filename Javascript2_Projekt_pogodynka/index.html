<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <title>Portal z prognozą pogody</title>
    <link rel="stylesheet" href="style_weather.css" />
    <meta name="author" content="Arkadiusz Grygoruk" />
    <meta name="description" content="" />
    <meta name="keywords" content="Prognoza pogody" />
    <!-- <script type="text/javascript" src="script_weather.js" async></script> -->
  </head>
  <body>
    <div class="topBar">
      <div class="searchBar">
        <div class="searchInput">
          <input type="text" placeholder="Wyszukaj miasto">
          <div class="autocompleteSearch">
            <li>Białystok</li>
            <li>Białystok</li>
            <li>Białystok</li>
            <li>Białystok</li>
            <li>Białystok</li>
          </div>
          <div class="icon">
            <img class="searchIcon" src="icons/search_icon.png">
          </div>
        </div>
      </div>
      <!-- <select name ="miasta" id="miasta">
        <option value="bialystok">Białystok</option>
        <option value="warszawa">Warszawa</option>
        <option value="rzeszow">Rzeszów</option>
        <option value="poznan">Poznań</option>
        <option value="szczecin">Szczecin</option>
        <option value="torun">Toruń</option>
      </select> -->
    <!-- &nbsp; <button id="przycisk">Pobierz prognozę pogody!</button> -->
    </div>


   <div class="pageBody">

      <div class="currentWeather">
        <h2>Pogoda aktualna</h2>
        <div>Temperatura: <span class="temp"></span></div>
        <div><span class="icon">placeholder</span></div>
        <div>Zachmurzenie: <span class="cloudy"></span></div>
        <div>Prędkość wiatru: <span class="windSpeed"></span></div>
        <div>Kierunek wiatru: <span class="windDirection"></span></div>
        <div>Wschód słońca: <span class="sunrise"></span></div>
        <div>Zachód słońca: <span class="sunset"></span></div>
      </div>

      <div class="pogodaKolejne">
        <h2>Prognoza na kolejne dni</h2>
        <div class="pogodaJutro">
          <div><span class="ikona"></span></div>
          <div>Temperatura: <span class="temp"></span></div>
          <div>Zachmurzenie: <span class="zachmurzenie"></span></div>
        </div>

        <div class="pogodaPojutrze">
          <div><span class="ikona"></span></div>
          <div>Temperatura: <span class="temp"></span></div>
          <div>Zachmurzenie: <span class="zachmurzenie"></span></div>
        </div>
      </div>

      <div class="map">

      </div>
   </div>

    <div class="bottomBar">
      <div class="bottomBar_content">
        <div class="bottomBar_text">
          Wykonane przez: Arkadiusz Grygoruk, studia podyplomowe - Tester Manualny 1, 2021/2022
    </div>
    <script>

      fetchList();
      getList();
      makeList();


      function makeList(list){
        let citiesList = list;
        console.log(citiesList);
      }

      function getList(response){
        response.json().then(makeList);
      }

      function fetchList(){
        fetch("https://www.wowapi.pl/pogoda/miasta")
        .then(getList);
      }


      // fetchData();
      let elementDzisTemp = document.querySelector(".currentWeather .temp");
      let elementDzisZachmurzenie = document.querySelector(".currentWeather .cloudy");
      let elementDzisPredkoscWiatru = document.querySelector(".currentWeather .windSpeed");
      let elementDzisKierunekWiatru = document.querySelector(".currentWeather .windDirection");
      let elementDzisWschodSlonca = document.querySelector(".currentWeather .sunrise");
      let elementDzisZachodSlonca = document.querySelector(".currentWeather .sunset");

      let elementJutroTemp = document.querySelector(".pogodaJutro .temp");
      let elementJutroZachmurzenie = document.querySelector(".pogodaJutro .zachmurzenie");

      let elementPojutrzeTemp = document.querySelector(".pogodaPojutrze .temp");
      let elementPojutrzeZachmurzenie = document.querySelector(".pogodaPojutrze .zachmurzenie");

      let elementPrzycisk = document.querySelector("#przycisk");

      
      function rozpakujDane(dane) {
        let dzisTemp = dane.teraz.temperatura;
        let dzisZachm = dane.teraz.zachmurzenie;
        let dzisPredkoscWiatru = dane.teraz.wiatrPrędkość;
        let dzisKierunekWiatru = dane.teraz.wiatrKierunekSłownie;
        let dzisWschodSlonca = dane.teraz.wschódSłońca;
        let dzisZachodSlonca = dane.teraz.zachódSłońca;

        let jutroTemp = dane.prognoza.jutro.temperatura;
        let jutroZachm = dane.prognoza.jutro.zachmurzenie;

        let pojutrzeTemp = dane.prognoza.pojutrze.temperatura;
        let pojutrzeZachm = dane.prognoza.pojutrze.zachmurzenie;

        elementDzisTemp.innerHTML = dzisTemp + " C";
        elementDzisZachmurzenie.innerHTML = dzisZachm + "%";
        elementDzisPredkoscWiatru.innerHTML = dzisPredkoscWiatru + " km/h";
        elementDzisKierunekWiatru.innerHTML = dzisKierunekWiatru;
        elementDzisWschodSlonca.innerHTML = dzisWschodSlonca;
        elementDzisZachodSlonca.innerHTML = dzisZachodSlonca;

        elementJutroTemp.innerHTML = jutroTemp + " C";
        elementJutroZachmurzenie.innerHTML = jutroZachm + "%";

        elementPojutrzeTemp.innerHTML = pojutrzeTemp + " C";
        elementPojutrzeZachmurzenie.innerHTML = pojutrzeZachm + "%";

      }

      function odbierzDane(response) {
        response.json().then(rozpakujDane);
      }

      function fetchData() {
        let miasto = miasta.value;
        fetch("https://www.wowapi.pl/pogoda/prognoza?miasto=" + miasto)
          // fetch("https://www.wowapi.pl/pogoda/miasta")
          .then(odbierzDane);
      }

      // document.querySelector("#przycisk").addEventListener("click", pobierzDane);

      // mozna dac event listener na change w selekcie (rozwijanej liscie)- wtedy od razu po zmianie elementu z listy
      // document.querySelector("#miasta").addEventListener("change", fetchData);
    </script>
  </body>
</html>
